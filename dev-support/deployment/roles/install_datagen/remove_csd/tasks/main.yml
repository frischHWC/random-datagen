---
- name: Find CSD Jar name
  find:
    paths: "/opt/cloudera/csd/"
    patterns: 'DATAGEN*.jar'
  register: jars_compiled

- name: Remove CSD jar file
  file:
    path: "{{ item }}"
    state: absent
  with_items: "{{ jars_compiled.files | map(attribute='path') | list }}"

- name: Restart CM 
  systemd:
    state: restarted
    name: cloudera-scm-server

# TODO: make sure CM is restarted
- name: Wait 1 minute to make sure CM is restarted
  pause:
    seconds: 60